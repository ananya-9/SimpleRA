./server
LOAD EMPLOYEE
LOAD PROJECT
LOAD WORKS_ON
LOAD DEPARTMENT

temp <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM temp
CLEAR temp

temp1 <- CROSS EMPLOYEE EMPLOYEE
temp2 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM temp1
temp3 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE2_Ssn, EMPLOYEE1_Bdate, EMPLOYEE2_Bdate FROM temp2
temp4 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM temp3
Q2 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE2_Ssn, EMPLOYEE1_Bdate FROM temp4
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2
CLEAR temp1
CLEAR temp2
CLEAR temp3
CLEAR temp4

TEMP <- CROSS EMPLOYEE WORKS_ON
TEMP2 <- SELECT Ssn == Essn FROM TEMP
TEMP3 <- PROJECT Ssn, Sex, Pno FROM TEMP2
FEM <- SELECT Sex == 1 FROM TEMP3
MAL <- SELECT Sex == 0 FROM TEMP3
TEMP4 <- CROSS FEM MAL
TEMP5 <- SELECT FEM_Pno == MAL_Pno FROM TEMP4
Q3 <- PROJECT FEM_Pno FROM TEMP5
RENAME FEM_Pno TO Pno FROM Q3
CLEAR TEMP
CLEAR TEMP2
CLEAR TEMP3
CLEAR TEMP4
CLEAR TEMP5
CLEAR MAL
CLEAR FEM



T <- CROSS EMPLOYEE WORKS_ON
T2 <- SELECT Ssn == Essn FROM T
T3 <- PROJECT Ssn, Super_ssn, Pno FROM T2
T4 <- CROSS T3 T3
T5 <- SELECT T31_Pno == T32_Pno FROM T4
T6 <- SELECT T31_Super_ssn == T32_Ssn FROM T5
Q4 <- PROJECT T31_Ssn, T31_Super_ssn, T31_Pno FROM T6
RENAME T31_Ssn TO Ssn FROM Q4
RENAME T31_Super_ssn TO Super_ssn FROM Q4
RENAME T31_Pno TO Pno FROM Q4
CLEAR T
CLEAR T2
CLEAR T3
CLEAR T4
CLEAR T5
CLEAR T6


Q5 <- SELECT Dnum != 4 FROM PROJECT


EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5
		
		


